# Project Technical Documentation: HospiCo

## 1. High-Level Architecture Overview
HospiCo is a robust full-stack web application designed for hospital booking and management. It uses a decoupled **Client-Server Architecture**:

*   **Frontend (Client)**: A Single Page Application (SPA) built with **React** and **TypeScript**, managed by **Vite**. It handles the user interface, state management, and interaction logic.
*   **Backend (Server)**: A RESTful API built with **Spring Boot** (Java). It handles business logic, security, and data persistence.
*   **Database**: **PostgreSQL** (hosted on Render) is used as the relational database management system.
*   **Communication**: The frontend handles data via HTTP requests (Axios) to the backend REST endpoints.
*   **Security**: Authentication is managed via **JWT (JSON Web Tokens)**.

---

## 2. Backend Technologies & Architecture
**Root Path**: `/backend`

### Core Technologies
*   **Language**: Java 21
*   **Framework**: Spring Boot 3.4.5
*   **Build Tool**: Maven

### Key Dependencies & Modules
| Dependency | Purpose |
| :--- | :--- |
| `spring-boot-starter-web` | RESTful API creation |
| `spring-boot-starter-data-jpa` | ORM (Hibernate) for database interaction |
| `spring-boot-starter-security` | Authentication & Authorization |
| `spring-boot-starter-validation` | Input validation |
| `postgresql` | JDBC Driver for PostgreSQL |
| `lombok` | Code boilerplate reduction (Getters, Setters, etc.) |
| `jjwt` (0.11.5) | JSON Web Token generation and validation |
| `springdoc-openapi` (2.8.0) | API Documentation (Swagger) |
| `google-api-client` (2.5.0) | Google Service integrations |

### Internal Architecture (Package Structure)
The backend follows a standard Controller-Service-Repository pattern under `com.hospitalfinder.backend`:

1.  **`controller`**: Handles incoming HTTP requests.
    *   `LoginController`, `SignupController`: Auth logic.
    *   `UserController`: Profile management.
    *   `ClinicController`, `DoctorController`: Search and details for medical entities.
    *   `AppointmentController`: Booking logic.
    *   `MedicalRecordController`: Health records.
2.  **`service`**: Contains business logic and transaction management.
3.  **`repository`**: Interfaces for CRUD operations (extending `JpaRepository`).
4.  **`entity`**: JPA Entities mapping to Database tables (`User`, `Clinic`, `Appointment`, `Doctor`, `MedicalRecord`, `Review`, `Specialization`).
5.  **`dto`**: Data Transfer Objects for API requests/responses.
6.  **`config`**: Security configuration (JWT filters, cleanup).
7.  **`exception`**: Global error handling mechanisms.

---

## 3. Frontend Technologies & Architecture
**Root Path**: `/hospico-frontend-main`

### Core Technologies
*   **Framework**: React 19.1.1
*   **Language**: TypeScript
*   **Bundler**: Vite 7.1.7
*   **State Management**: Redux Toolkit + Redux Persist

### Key Libraries & Packages
| Package | Purpose |
| :--- | :--- |
| `react-router-dom` (7.x) | Client-side routing |
| `axios` | HTTP Client for API calls |
| `@mui/material` & `@emotion` | UI Component Library |
| `tailwindcss` (4.x) | Utility-first CSS framework |
| `styled-components` | CSS-in-JS styling |
| `lucide-react` | Icons |

### Page-to-Feature Mapping
Logic and UI are distributed across pages in `src/pages`, utilizing shared `components` and `features`.

| Page Route | Component (`src/pages`) | Backend API Dependencies (Inferred) | Purpose |
| :--- | :--- | :--- | :--- |
| `/login` | `Login.tsx` | `LoginController` | User authentication. |
| `/signup` | `Signup.tsx` | `SignupController` | User registration. |
| `/partner-login` | `PartnerLogin.tsx` | `LoginController` | Auth for Hospital Admins/Doctors. |
| `/dashboard` | `Dashboard.tsx` | `UserController`, `AppointmentController` | Main user hub (protected). |
| `/find-hospitals` | `FindHospitals.tsx` | `ClinicController`, `SpecializationController` | Search & Filter hospitals. |
| `/find-hospital/:id` | `HospitalProfile.tsx` | `ClinicController`, `DoctorController`, `ReviewController` | Detailed view of a hospital. |
| `/my-appointments` | `MyAppointments.tsx` | `AppointmentController` | View and manage bookings. |
| `/reports` | `MedicalReports.tsx` | `MedicalRecordController` | Access medical history/reports. |
| `/profile` | `Profile.tsx` | `UserController` | Edit user details. |
| `/emergency` | `Emergency.tsx` | `ClinicController` (Filtered) | Quick access to emergency contacts. |

---

## 4. Database Info
*   **System**: PostgreSQL
*   **Database Name**: `hospital_booking_k625`
*   **Host**: Render (Cloud)
*   **Schema**: Automatically managed via Hibernate (`ddl-auto=update`), mapping directly to the `entity` classes designated in the backend.

## 5. Deployment & Configuration
*   **Server Port**: `8080` (Backend)
*   **Client Port**: `5173` (Frontend default)
*   **CORS**: Backend explicitly authorizes `http://localhost:5173`.
*   **Environment**:
    *   Backend config uses `application.properties`.
    *   Frontend uses standard Vite environment setup (implied).

---

## 6. Mobile Deployment Strategy (Google Play Store)
*(Note: The current specific implementation uses **Capacitor + React** (Hybrid), which follows this deployment structure).*

### 6.1 Google Play Store Requirements
*   **Developer Account**:
    *   **Process**: Sign up at [Play Console](https://play.google.com/console). Requires a Google account.
    *   **Cost**: **$25 USD (approx. ₹2,100 INR)**. This is a **one-time** registration fee. There are no recurring annual fees for the Basic Play Console account.
    *   **Verification**: You will need a valid ID and a credit/debit card for payment. Google may ask for address verification.
*   **Legal Requirements**:
    *   **Privacy Policy**: Mandatory. You must host a URL (e.g., on your website) explaining how you handle user data (especially since this is a healthcare app).
    *   **Terms & Conditions**: Recommended but not strictly enforced by the store itself (though good for liability).
    *   **Data Safety Section**: You must complete a questionnaire in the Play Console declaring what data you collect (e.g., Location, Health info) and why.

### 6.2 Technical Dependencies
To build the release APK/AAB for this Capacitor project:
*   **Tools**:
    *   **Android Studio**: Required for the final build and signing process.
    *   **Java Development Kit (JDK)**: Version 17 is generally recommended for modern Gradle plugins (Project uses Java 21, check compatibility).
    *   **Android SDK**: Install via Android Studio (SDK Platforms and SDK Tools).
*   **Project Config**:
    *   Run `npx cap sync android` to ensure the `android/` folder is up to date with your React code.
    *   Run `npx cap open android` to open the project in Android Studio.
*   **Signing**:
    *   **Upload Key**: You generate this locally using `keytool` or Android Studio. This signs the binary you upload to Google.
    *   **Play App Signing**: Highly recommended. Google manages the actual signing key delivered to devices. You upload with your "Upload Key", and Google re-signs it with the secure "App Signing Key".

### 6.3 App Packaging & Release Process
1.  **Prepare Release Build**:
    *   Update `versionCode` (integer, e.g., 10) and `versionName` (string, e.g., "1.0.0") in `android/app/build.gradle`.
    *   Run `npm run build` to create the production web assets.
    *   Run `npx cap sync` to copy assets to the Android platform.
2.  **Generate Bundle (AAB)**:
    *   Open Android Studio (`npx cap open android`).
    *   Go to **Build > Generate Signed Bundle / APK**.
    *   Choose **Android App Bundle (AAB)** (preferred over APK for multiple reasons like smaller download size).
    *   Create a new Keystore (keep this file SAFE, if you lose it, you cannot update the app).
    *   Select `release` build variant.
3.  **Upload to Play Store**:
    *   Create a **Production** release in Play Console.
    *   Upload the `.aab` file.
    *   Fill out the **Store Listing**:
        *   **App Icon**: 512x512 PNG.
        *   **Feature Graphic**: 1024x500 PNG.
        *   **Screenshots**: at least 2 screenshots.
        *   **Description**: Short (80 chars) and Long description.

### 6.4 Maintenance & Updates
*   **Versioning**: 
    *   Every update MUST have a higher `versionCode` than the previous one. `versionName` is just for display.
*   **Live Updates vs Full Updates**:
    *   **Full Update**: Required for Native changes (plugins, permission changes, icon changes). Users must download from the Play Store.
    *   **Live Update (OTA)**: Using services like *Ionic Appflow* or *Microsoft CodePush*, you can push JS/CSS changes immediately without a store review (optional, costs extra/requires setup).
*   **Backend Changes**:
    *   **Backward Compatibility**: The mobile app cannot be "refreshed" instantly like a website. Old versions will exist in the wild. **NEVER** break existing API endpoints. Version your API (e.g., `/api/v1/login`, `/api/v2/login`) if you need breaking changes.

### 6.5 Costs & Scaling Considerations
*   **Initial Cost**: ₹2,100 INR (Play Store Fee).
*   **Ongoing Costs**:
    *   **Google Play**: ₹0/month.
    *   **Backend Hosting (Render)**: Free tier is okay for dev, but for production, expect ~$7-25/month for scaling.
    *   **Chatbot API**: If using Gemini/OpenAI, costs scale with usage (tokens). Monitor usage limits.
*   **Scaling**:
    *   As users grow, your database and backend are the bottlenecks, not the app store. Mobile apps are just clients. Focus on optimizing backend queries.

### 6.6 Best Practices & Common Mistakes (Chatbot Focus)
*   **Rejection Reasons**:
    *   **Broken Functionality**: Submitting an app that crashes on login or empty states.
    *   **Incomplete Login Credentials**: You MUST provide Google a demo "Test Account" (username/password) so reviewers can log in and test the dashboard.
    *   **Medical Policy**: Since this is "HospiCo", Google performs strict review on "Medical" apps. You must declare if you are a "Health App" and might need to prove you are an authorized healthcare provider or explicitly state you are "Information only" (disclaimer).
*   **Security**:
    *   Never store API Keys in the frontend code (React). Proxy all calls through your Spring Boot backend.
*   **User Trust**:
    *   Since it's a chatbot, clear specific disclaimers ("Not a medical diagnosis") are crucial to avoid liability and store rejection.
